\lstset{language=C, backgroundcolor=\color{lightgray}, frame=single, basicstyle=\footnotesize\ttfamily, captionpos=b, tabsize=2, inputpath=csnippets}

\lstdefinestyle{CStyle}{
    backgroundcolor=\color{lightgray!20},   
    commentstyle=\color{gray},
    keywordstyle=\color{blue},
    numberstyle=\tiny\color{gray},
    stringstyle=\color{violet},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    language=C,
    classoffset = 1,
    morekeywords = {qBool_t, qTask_t, qPriority_t, qIteration_t, qState_t, qTime_t, qGetTickFcn_t, qTimingBase_t, qTaskFcn_t, qEvent_t, qCR_Begin, qCR_End, qCR_Yield, qUINT8_t, qUINT16_t, qUINT32_t, size_t, qINT8_t, qINT16_t, qINT32_t, qFloat32_t, qFloat64_t, qTask_GlobalState_t, qTaskFlag_t, qTrigger_t, qQueue_t, qQueue_LinkMode_t, qSTimer_t, qClock_t, qSM_t, qSM_Status_t, qSM_Handler_t, qSM_State_t, qSM_SubState_t, qSM_Attribute_t, qSM_TransitionTable_t, qSM_Transition_t, qSM_Signal_t, qCR_Delay, qCR_WaitUntil, qCR_TimedWaitUntil, qCR_Do, qCR_Until, qCR_PositionGet, qCR_PositionRestore, qCR_PositionReset, qCR_SemInit, qCR_SemWait, qCR_SemSignal, qCR_Semaphore_t, qATCLI_t, qPutChar_t, qATCLI_Command_t, qATCLI_CommandCallback_t, qATCLI_Options_t, qATCLI_Response_t, qATCLI_PreCmd_t, qATCLI_Handler_t, qMemMang_Pool_t, qTrace_Message, qTrace_Var, qTrace_Variable, qDebug_Var, qDebug_Variable, qTrace, qDebug, qTrace_Mem, qTrace_Memory, qBSBuffer_t, qEdgeCheck_t, qCoreRegSize_t, qEdgeCheck_IONode_t, qList_t, qList_Position_t, qList_Direction_t, qList_NodeFcn_t, qList_Iterator_t, qResponse_t, qGetChar_t, qTask_NotifyMode_t, qCycles_t, PID_Params_t, qCR_Position_t, qCR_Handle_t, qCR_BeginWithHandle, qCR_ExternAction_t, qCR_ExtPosition_t, qList_CompareHandle_t, qList_ForEachHandle_t, qSM_SurroundingState_t, qSM_SurroundingCallback_t, qSM_TimeoutSpecOptions_t, qSM_TimeoutSpec_t, qSM_TimeoutStateDefinition_t, qSM_StateCallback_t },    
    keywordstyle=\color{cyan!60!blue},
    classoffset = 2,
    morekeywords = { qPeriodic, qEnabled, qDisabled, qHigh_Priority, qMedium_Priority, qLowest_Priority, qTimeImmediate, qTrue, qFalse, QEVENTFLAG_01, QEVENTFLAG_02, QEVENTFLAG_03, QEVENTFLAG_04, QEVENTFLAG_SET, NULL, qQUEUE_EMPTY, qQUEUE_COUNT, qATTACH, byQueueCount, byQueueEmpty, byNotificationSimple, byNotificationQueued, byTimeElapsed, QSTIMER_INITIALIZER, qSM_STATUS_NULL, qSM_STATUS_BEFORE_ANY, qSM_STATUS_EXIT_SUCCESS, qSM_STATUS_EXIT_FAILURE, qSM_STATUS_SIGNAL_HANDLED, QSM_SIGNAL_USER, QSM_SIGNAL_ENTRY, QSM_SIGNAL_EXIT, QSM_SIGNAL_NONE, QSM_SIGNAL_TIMEOUT, QSM_SIGNAL_START, QATCLI_NORESPONSE, QATCLI_OK, QATCLI_CMDTYPE_PARA, QATCLI_CMDTYPE_ACT, QATCLI_CMDTYPE_TEST, QATCLI_CMDTYPE_READ, QATCLI_ERROR, qATCLI_NORESPONSE, qATCLI_OK, qATCLI_CMDTYPE_PARA, qATCLI_CMDTYPE_ACT, qATCLI_CMDTYPE_TEST, qATCLI_CMDTYPE_READ, qATCLI_ERROR, qNode_MinimalFields, qCR_RESUME, qCR_SUSPEND, qCR_RESTART, qQueueMode_Receiver, qQueueMode_Full, qQueueMode_Count, qQueueMode_Empty, QSM_TSOPT_INDEX, QSM_TSOPT_SET_ENTRY, QSM_TSOPT_RST_ENTRY, QSM_TSOPT_SET_EXIT, QSM_TSOPT_RST_EXIT, QSM_TSOPT_KEEP_IF_SET, QSM_TSOPT_PERIODIC, QSM_STATE_TOP, qFLM_ArraySize },    
    keywordstyle=\color{teal},    
    classoffset =3,
    morekeywords = {qOS_Setup, qClock_SysTick, qOS_Set_IdleTask, qOS_Add_Task, qOS_Add_EventTask, qOS_Remove_Task, qOS_Run, qOS_Set_SchedulerReleaseCallback, qCritical_SetInterruptsED, qTask_Set_Time, qTask_Set_Iterations, qTask_Set_Priority, qTask_Set_Callback, qTask_Set_State, qTask_Resume, qTask_Suspend, qTask_ASpeep, qTask_Awake, qTask_Set_Data, qTask_Clear, qTask_Get_Cycles, qTask_Get_State, qTask_Self, qTask_Get_GlobalState, qTask_ASleep, qTask_HasPendingNotifications, qTask_Notification_Send, qTask_Notification_Queue, qOS_Notification_Spread, qTask_EventFlags_Modify, qTask_EventFlags_Read, qTask_EventFlags_Check, qQueue_Setup, qQueue_SendToBack, qQueue_SendToFront, qQueue_Receive, qTask_Attach_Queue, qQueue_Reset, qQueue_IsEmpty, qQueue_Count, , qQueue_IsFull, qQueue_Peek, qQueue_RemoveFront, qSTimer_Set, qSTimer_FreeRun, qSTimer_Disarm, qSTimer_Elapsed, qSTimer_Remaining, qSTimer_Expired, qSTimer_Status, qStateMachine_Setup, qStateMachine_Run, qOS_Add_StateMachineTask, qStateMachine_Attribute, qStateMachine_TransitionTableInstall, qStateMachine_SignalQueueSetup, qStateMachine_SendSignal, qOS_StateMachineTask_SigCon, qStateMachine_Set_CompositeState, qATCLI_Setup, qATCLI_CmdSubscribe, qATCLI_ISRHandler, qATCLI_ISRHandlerBlock, qATCLI_Raise, qATCLI_Exec, qATCLI_Run, qOS_Add_ATCLITask, qATCLI_GetArgString, qATCLI_GetArgPtr, qATCLI_GetArgInt, qATCLI_GetArgFlt, qATCLI_GetArgHex, qMemMang_Pool_Select, qMenMang_Get_FreeSize, qMalloc, qFree, qTrace_Set_OutputFcn, qMemMang_Pool_Setup, qCR_ExternControl, qMemMang_Get_FreeSize, qStateMachine_SubStatesInstall, qStateMachine_InstallSignalQueue, qStateMachine_StateSubscribe, qStateMachine_SendSignal, qStateMachine_InstallTransitionTable, qStateMachine_InstallTimeoutSpec, qStateMachine_TimeoutSet, qStateMachine_TimeoutStop, qStateMachine_Set_StateTransitions, qStateMachine_Set_StateTimeouts, puts, GetArgInt, GetArgFlt, GetArgHex, GetArgString, GetArgPtr, putch },
    keywordstyle=\bfseries,
    classoffset = 0,
}